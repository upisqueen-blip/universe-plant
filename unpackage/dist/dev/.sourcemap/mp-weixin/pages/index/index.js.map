{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../../../softwares/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 顶部状态栏 -->\r\n\t\t<view class=\"status-bar\">\r\n\t\t\t<view class=\"status-item\">\r\n\t\t\t\t<text class=\"status-label\">状态</text>\r\n\t\t\t\t<text class=\"status-value\" :class=\"{ 'online': isOnline, 'offline': !isOnline }\">\r\n\t\t\t\t\t{{ isOnline ? '在线' : '离线' }}\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 中间花朵和传感器数据区域 -->\r\n\t\t<view class=\"flower-container\">\r\n\t\t\t<!-- 花朵图片 -->\r\n\t\t\t<view class=\"flower-wrapper\">\r\n\t\t\t\t<view class=\"flower-image\">\r\n\t\t\t\t\t<!-- 使用CSS创建花朵 -->\r\n\t\t\t\t\t<view class=\"flower-center\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-1\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-2\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-3\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-4\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-5\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-6\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-7\"></view>\r\n\t\t\t\t\t<view class=\"petal petal-8\"></view>\r\n\t\t\t\t\t<view class=\"stem\"></view>\r\n\t\t\t\t\t<view class=\"leaf leaf-left\"></view>\r\n\t\t\t\t\t<view class=\"leaf leaf-right\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 传感器数据显示 -->\r\n\t\t\t<view class=\"sensor-data\">\r\n\t\t\t\t<view class=\"sensor-item\">\r\n\t\t\t\t\t<text class=\"sensor-label\">温度</text>\r\n\t\t\t\t\t<text class=\"sensor-value\">{{ temperature }}°C</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"sensor-item\">\r\n\t\t\t\t\t<text class=\"sensor-label\">湿度</text>\r\n\t\t\t\t\t<text class=\"sensor-value\">{{ humidity }}%</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"sensor-item\">\r\n\t\t\t\t\t<text class=\"sensor-label\">水位</text>\r\n\t\t\t\t\t<text class=\"sensor-value\">{{ waterLevel }}cm</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 底部按钮区域 -->\r\n\t\t<view class=\"button-container\">\r\n\t\t\t<button class=\"control-btn\" :class=\"{ 'on': switches[0], 'off': !switches[0] }\" @click=\"sendCommand(0)\">\r\n\t\t\t\t开关1 {{ switches[0] ? '开' : '关' }}\r\n\t\t\t</button>\r\n\t\t\t<button class=\"control-btn\" :class=\"{ 'on': switches[1], 'off': !switches[1] }\" @click=\"sendCommand(1)\">\r\n\t\t\t\t开关2 {{ switches[1] ? '开' : '关' }}\r\n\t\t\t</button>\r\n\t\t\t<button class=\"control-btn\" :class=\"{ 'on': switches[2], 'off': !switches[2] }\" @click=\"sendCommand(2)\">\r\n\t\t\t\t开关3 {{ switches[2] ? '开' : '关' }}\r\n\t\t\t</button>\r\n\t\t\t<button class=\"control-btn\" :class=\"{ 'on': switches[3], 'off': !switches[3] }\" @click=\"sendCommand(3)\">\r\n\t\t\t\t开关4 {{ switches[3] ? '开' : '关' }}\r\n\t\t\t</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 连接状态提示 -->\r\n\t\t<view class=\"connection-status\" v-if=\"showConnectionStatus\">\r\n\t\t\t<text>{{ connectionMessage }}</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\r\n\t// #ifdef H5\r\n\t// H5环境从全局对象获取mqtt.min.js库\r\n\tlet mqtt;\r\n\t// 在H5环境中，mqtt.min.js已通过index.html加载到全局对象\r\n\tif (typeof window !== 'undefined' && window.mqtt) {\r\n\t\tmqtt = window.mqtt;\r\n\t} else {\r\n\t\tconsole.error('mqtt.min.js未加载到全局对象');\r\n\t}\r\n\t// #endif\r\n\t\r\n\t// #ifdef MP-WEIXIN\r\n\t// 微信小程序环境使用require方式导入mqtt.js库\r\n\tlet mqtt;\r\n\ttry {\r\n\t\tmqtt = require('../../static/mqtt.js');\r\n\t} catch (e) {\r\n\t\tconsole.error('加载mqtt.js失败:', e);\r\n\t}\r\n\t// #endif\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 当前运行环境：'mp'表示小程序，'browser'表示浏览器\r\n\t\t\t\tenvironment: '',\r\n\t\t\t\t// 设备ID，用于生成客户端ID\r\n\t\t\t\tdeviceId: 'device001',\r\n\t\t\t\tisOnline: false,\r\n\t\t\t\ttemperature: 25,\r\n\t\t\t\thumidity: 60,\r\n\t\t\t\twaterLevel: 10,\r\n\t\t\t\tshowConnectionStatus: false,\r\n\t\t\t\tconnectionMessage: '',\r\n\t\t\t\tmqttClient: null,\r\n\t\t\t\tmqttOptions: {\r\n\t\t\t\t\thost: 'fnos.insane.vip', // MQTT服务器地址，可根据实际情况修改\r\n\t\t\t\t\tport: 8083, // WebSocket端口\r\n\t\t\t\t\tpath: '/mqtt',\r\n\t\t\t\t\tclientId: 'uniapp_' + Math.random().toString(16).substr(2, 8),\r\n\t\t\t\t\tusername: 'qq1739', // 用户名，如果需要\r\n\t\t\t\t\tpassword: '123456' // 密码，如果需要\r\n\t\t\t\t},\r\n\t\t\t\t// 开关状态\r\n\t\t\t\tswitches: [false, false, false, false], // sw1, sw2, sw3, sw4\r\n\t\t\t\t// 定时器\r\n\t\t\t\tstatusTimer: null,\r\n\t\t\t\t// 连续无回复计数\r\n\t\t\t\tnoReplyCount: 0,\r\n\t\t\t\t// 最大无回复次数\r\n\t\t\t\tmaxNoReplyCount: 10\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// 初始化MQTT连接\r\n\t\t\tthis.initMQTT();\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\t// 清理定时器\r\n\t\t\tif (this.statusTimer) {\r\n\t\t\t\tclearInterval(this.statusTimer);\r\n\t\t\t}\r\n\t\t\t// 关闭MQTT连接\r\n\t\t\tif (this.mqttClient) {\r\n\t\t\t\t// #ifdef H5 || MP-WEIXIN\r\n\t\t\t\t// H5和微信小程序环境都使用mqtt.end()关闭连接\r\n\t\t\t\tthis.mqttClient.end();\r\n\t\t\t\t// #endif\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\r\n\r\n\t\t\t// 初始化MQTT连接\r\n\t\t\tinitMQTT() {\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\t// H5环境使用mqtt.js库\r\n\t\t\t\tthis.initMQTTForBrowser();\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifndef H5\r\n\t\t\t\t// 非H5环境（包括小程序）使用WebSocket实现MQTT协议\r\n\t\t\t\tthis.initMQTTForMP();\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\r\n\t\t\t// 小程序环境的MQTT连接\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t// 微信小程序环境的MQTT连接\r\n\t\t\tinitMQTTForMP() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 根据已验证的代码，使用mqtt.min.js库而不是原生WebSocket\r\n\t\t\t\t\tconsole.log('小程序环境尝试连接MQTT服务器');\r\n\r\n\t\t\t\t\t// 检查mqtt对象是否存在\r\n\t\t\t\t\tif (typeof mqtt === 'undefined') {\r\n\t\t\t\t\t\tconsole.error('mqtt对象未定义，尝试加载mqtt.min.js');\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT库未加载，请重试';\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 构建连接URL，格式与已验证代码一致\r\n\t\t\t\t\tconst clientId = \"wx_\" + this.deviceId + \"_\" + new Date().getTime();\r\n\t\t\t\t\tconsole.log('使用客户端ID:', clientId);\r\n\r\n\t\t\t\t\t// 使用wxs协议，与已验证代码保持一致\r\n\t\t\t\t\tconst wsUrl = `wx://${this.mqttOptions.host}:${this.mqttOptions.port}/mqtt`;\r\n\t\t\t\t\tconsole.log('连接URL:', wsUrl);\r\n\r\n\t\t\t\t\t// 创建MQTT连接，使用与已验证代码相同的参数\r\n\t\t\t\t\tthis.mqttClient = mqtt.connect(wsUrl, {\r\n\t\t\t\t\t\tclientId: clientId,\r\n\t\t\t\t\t\tusername: this.mqttOptions.username,\r\n\t\t\t\t\t\tpassword: this.mqttOptions.password,\r\n\t\t\t\t\t\tkeepalive: 60,\r\n\t\t\t\t\t\treconnectPeriod: 1000,\r\n\t\t\t\t\t\tconnectTimeout: 30 * 1000,\r\n\t\t\t\t\t\tprotocolVersion: 4 // MQTT 3.1.1\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听连接事件\r\n\t\t\t\t\tthis.mqttClient.on('connect', () => {\r\n\t\t\t\t\t\tconsole.log('小程序MQTT连接成功');\r\n\t\t\t\t\t\tthis.isOnline = true;\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT服务器连接成功';\r\n\r\n\t\t\t\t\t\t// 连接成功后订阅主题\r\n\t\t\t\t\t\tthis.mqttClient.subscribe('mqttpub', {\r\n\t\t\t\t\t\t\tqos: 1\r\n\t\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\t\tconsole.log('已订阅主题: mqttpub');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.error('订阅主题失败:', err);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 发送初始化命令\r\n\t\t\t\t\t\tthis.sendInitCommand();\r\n\r\n\t\t\t\t\t\t// 启动定时器，每3秒发送一次cmd6\r\n\t\t\t\t\t\tthis.statusTimer = setInterval(() => {\r\n\t\t\t\t\t\t\tthis.sendInitCommand();\r\n\t\t\t\t\t\t}, 3000);\r\n\r\n\t\t\t\t\t\t// 3秒后隐藏连接状态提示\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.showConnectionStatus = false;\r\n\t\t\t\t\t\t}, 3000);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听消息事件\r\n\t\t\t\t\tthis.mqttClient.on('message', (topic, message) => {\r\n\t\t\t\t\t\tconsole.log('收到MQTT消息:', topic, message.toString());\r\n\t\t\t\t\t\tthis.handleMQTTMessage(message.toString());\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听错误事件\r\n\t\t\t\t\tthis.mqttClient.on('error', (err) => {\r\n\t\t\t\t\t\tconsole.error('MQTT连接错误:', err);\r\n\t\t\t\t\t\tthis.isOnline = false;\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT连接失败，请检查网络';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听断开连接事件\r\n\t\t\t\t\tthis.mqttClient.on('close', () => {\r\n\t\t\t\t\t\tconsole.log('MQTT连接关闭');\r\n\t\t\t\t\t\tthis.isOnline = false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('初始化小程序MQTT失败:', error);\r\n\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\tthis.connectionMessage = 'MQTT初始化失败';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\r\n\t\t\t// 浏览器环境的MQTT连接\r\n\t\t\t// #ifdef H5\r\n\t\t\t// H5环境的MQTT连接\r\n\t\t\tinitMQTTForBrowser() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 检查mqtt对象是否存在\r\n\t\t\t\t\tif (typeof mqtt === 'undefined') {\r\n\t\t\t\t\t\tconsole.error('mqtt对象未定义，无法初始化浏览器MQTT连接');\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT库未加载，请刷新页面重试';\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 使用mqtt.min.js中的mqtt对象\r\n\t\t\t\t\tconst wsUrl = `mqtt://${this.mqttOptions.host}:${this.mqttOptions.port}${this.mqttOptions.path}`;\r\n\r\n\t\t\t\t\t// 创建MQTT客户端\r\n\t\t\t\t\tthis.mqttClient = mqtt.connect(wsUrl, {\r\n\t\t\t\t\t\tclientId: this.mqttOptions.clientId,\r\n\t\t\t\t\t\tusername: this.mqttOptions.username,\r\n\t\t\t\t\t\tpassword: this.mqttOptions.password,\r\n\t\t\t\t\t\tkeepalive: 60,\r\n\t\t\t\t\t\treconnectPeriod: 1000,\r\n\t\t\t\t\t\tconnectTimeout: 30 * 1000\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听连接事件\r\n\t\t\t\t\tthis.mqttClient.on('connect', () => {\r\n\t\t\t\t\t\tconsole.log('浏览器MQTT连接成功');\r\n\t\t\t\t\t\tthis.isOnline = true;\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT服务器连接成功';\r\n\r\n\t\t\t\t\t\t// 连接成功后订阅主题\r\n\t\t\t\t\t\tthis.mqttClient.subscribe('mqttpub', {\r\n\t\t\t\t\t\t\tqos: 1\r\n\t\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\t\tif (!err) {\r\n\t\t\t\t\t\t\t\tconsole.log('已订阅主题: mqttpub');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.error('订阅主题失败:', err);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// 发送初始化命令\r\n\t\t\t\t\t\tthis.sendInitCommand();\r\n\r\n\t\t\t\t\t\t// 启动定时器，每3秒发送一次cmd6\r\n\t\t\t\t\t\tthis.statusTimer = setInterval(() => {\r\n\t\t\t\t\t\t\tthis.sendInitCommand();\r\n\t\t\t\t\t\t}, 3000);\r\n\r\n\t\t\t\t\t\t// 3秒后隐藏连接状态提示\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.showConnectionStatus = false;\r\n\t\t\t\t\t\t}, 3000);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听消息事件\r\n\t\t\t\t\tthis.mqttClient.on('message', (topic, message) => {\r\n\t\t\t\t\t\tconsole.log('收到MQTT消息:', topic, message.toString());\r\n\t\t\t\t\t\tthis.handleMQTTMessage(message.toString());\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听错误事件\r\n\t\t\t\t\tthis.mqttClient.on('error', (err) => {\r\n\t\t\t\t\t\tconsole.error('MQTT连接错误:', err);\r\n\t\t\t\t\t\tthis.isOnline = false;\r\n\t\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\t\tthis.connectionMessage = 'MQTT连接失败，请检查网络';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 监听断开连接事件\r\n\t\t\t\t\tthis.mqttClient.on('close', () => {\r\n\t\t\t\t\t\tconsole.log('MQTT连接关闭');\r\n\t\t\t\t\t\tthis.isOnline = false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('初始化MQTT失败:', error);\r\n\t\t\t\t\tthis.showConnectionStatus = true;\r\n\t\t\t\t\tthis.connectionMessage = 'MQTT初始化失败';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\r\n\r\n\r\n\t\t\t// 字符串转字节数组\r\n\t\t\tstringToBytes(str) {\r\n\t\t\t\tconst bytes = [];\r\n\t\t\t\tfor (let i = 0; i < str.length; i++) {\r\n\t\t\t\t\tconst code = str.charCodeAt(i);\r\n\t\t\t\t\tif (code < 0x80) {\r\n\t\t\t\t\t\tbytes.push(code);\r\n\t\t\t\t\t} else if (code < 0x800) {\r\n\t\t\t\t\t\tbytes.push(0xc0 | (code >> 6));\r\n\t\t\t\t\t\tbytes.push(0x80 | (code & 0x3f));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbytes.push(0xe0 | (code >> 12));\r\n\t\t\t\t\t\tbytes.push(0x80 | ((code >> 6) & 0x3f));\r\n\t\t\t\t\t\tbytes.push(0x80 | (code & 0x3f));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn bytes;\r\n\t\t\t},\r\n\r\n\t\t\t// 订阅主题（小程序环境）\r\n\t\t\tsubscribeToTopic(topic) {\r\n\t\t\t\tif (this.environment !== 'mp') return;\r\n\r\n\t\t\t\t// 构建MQTT SUBSCRIBE包\r\n\t\t\t\tconst subscribePacket = this.buildMQTTSubscribePacket(topic);\r\n\r\n\t\t\t\t// 发送SUBSCRIBE包\r\n\t\t\t\tuni.sendSocketMessage({\r\n\t\t\t\t\tdata: subscribePacket\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconsole.log(`已订阅主题: ${topic}`);\r\n\t\t\t},\r\n\r\n\t\t\t// 构建MQTT SUBSCRIBE包\r\n\t\t\tbuildMQTTSubscribePacket(topic) {\r\n\t\t\t\tconst packet = [];\r\n\r\n\t\t\t\t// 固定头\r\n\t\t\t\tpacket.push(0x82); // SUBSCRIBE命令\r\n\r\n\t\t\t\t// 可变头\r\n\t\t\t\tpacket.push(0x00); // 包标识符MSB\r\n\t\t\t\tpacket.push(0x01); // 包标识符LSB\r\n\r\n\t\t\t\t// 主题过滤器\r\n\t\t\t\tconst topicBytes = this.stringToBytes(topic);\r\n\t\t\t\tpacket.push(topicBytes.length >> 8); // 长度MSB\r\n\t\t\t\tpacket.push(topicBytes.length & 0xFF); // 长度LSB\r\n\t\t\t\tfor (let i = 0; i < topicBytes.length; i++) {\r\n\t\t\t\t\tpacket.push(topicBytes[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 服务质量等级\r\n\t\t\t\tpacket.push(0x01); // QoS 1\r\n\r\n\t\t\t\t// 计算剩余长度\r\n\t\t\t\tconst remainingLength = packet.length - 1; // 减去固定头\r\n\r\n\t\t\t\t// 构建最终包\r\n\t\t\t\tconst finalPacket = [0x82]; // 固定头\r\n\r\n\t\t\t\t// 添加剩余长度（使用MQTT编码）\r\n\t\t\t\tlet len = remainingLength;\r\n\t\t\t\tdo {\r\n\t\t\t\t\tlet byte = len & 0x7F;\r\n\t\t\t\t\tlen >>= 7;\r\n\t\t\t\t\tif (len > 0) byte |= 0x80;\r\n\t\t\t\t\tfinalPacket.push(byte);\r\n\t\t\t\t} while (len > 0);\r\n\r\n\t\t\t\t// 添加剩余内容（跳过原来的固定头）\r\n\t\t\t\tfor (let i = 1; i < packet.length; i++) {\r\n\t\t\t\t\tfinalPacket.push(packet[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn new Uint8Array(finalPacket);\r\n\t\t\t},\r\n\r\n\r\n\r\n\t\t\t// 发送初始化命令 {cmd:6}\r\n\t\t\tsendInitCommand() {\r\n\t\t\t\tconst command = {\r\n\t\t\t\t\t\"cmd\": 6\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 不论是小程序还是浏览器环境，都使用mqtt.publish发送消息\r\n\t\t\t\tif (this.mqttClient && this.mqttClient.connected) {\r\n\t\t\t\t\tthis.mqttClient.publish('mqttsub', JSON.stringify(command), {\r\n\t\t\t\t\t\tqos: 1\r\n\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\tconsole.error('发送初始化命令失败:', err);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('发送初始化命令:', JSON.stringify(command));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 增加无回复计数\r\n\t\t\t\t\tthis.noReplyCount++;\r\n\r\n\t\t\t\t\t// 如果连续无回复次数达到阈值，标记设备为离线\r\n\t\t\t\t\tif (this.noReplyCount >= this.maxNoReplyCount && this.isOnline) {\r\n\t\t\t\t\t\tthis.isOnline = false;\r\n\t\t\t\t\t\tconsole.log(`设备已离线，连续${this.noReplyCount}次无回复`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn('MQTT客户端未连接，无法发送命令');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\r\n\r\n\t\t\t// 处理MQTT消息\r\n\t\t\thandleMQTTMessage(message) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst data = JSON.parse(message);\r\n\t\t\t\t\tconsole.log('收到MQTT消息:', data);\r\n\r\n\t\t\t\t\t// 如果是cmd6的回复，更新设备状态和数据\r\n\t\t\t\t\tif (data.cmd === 6 && data.data) {\r\n\t\t\t\t\t\t// 重置无回复计数器\r\n\t\t\t\t\t\tthis.noReplyCount = 0;\r\n\r\n\t\t\t\t\t\t// 如果设备之前是离线状态，现在标记为在线\r\n\t\t\t\t\t\tif (!this.isOnline) {\r\n\t\t\t\t\t\t\tthis.isOnline = true;\r\n\t\t\t\t\t\t\tconsole.log('设备已恢复在线');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 更新传感器数据\r\n\t\t\t\t\t\tif (data.data.temp !== undefined) {\r\n\t\t\t\t\t\t\tthis.temperature = data.data.temp;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (data.data.humidity !== undefined) {\r\n\t\t\t\t\t\t\tthis.humidity = data.data.humidity;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (data.data.level !== undefined) {\r\n\t\t\t\t\t\t\tthis.waterLevel = data.data.level;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 更新开关状态\r\n\t\t\t\t\t\tif (data.data.sw && Array.isArray(data.data.sw) && data.data.sw.length >= 4) {\r\n\t\t\t\t\t\t\t// 将数字状态转换为布尔值\r\n\t\t\t\t\t\t\tthis.switches = data.data.sw.map(state => state === 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 处理其他命令响应\r\n\t\t\t\t\tif (data.status) {\r\n\t\t\t\t\t\tconsole.log('设备状态:', data.status);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('解析MQTT消息失败:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 发送开关控制命令\r\n\t\t\tsendCommand(switchIndex) {\r\n\t\t\t\t// 切换开关状态\r\n\t\t\t\tthis.switches[switchIndex] = !this.switches[switchIndex];\r\n\r\n\t\t\t\t// 构建命令，确保字段名加双引号\r\n\t\t\t\tconst command = {\r\n\t\t\t\t\t\"cmd\": switchIndex + 2, // cmd2对应开关1，cmd3对应开关2，以此类推\r\n\t\t\t\t\t\"data\": this.switches[switchIndex] ? 1 : 0 // 1表示开启，0表示关闭\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 不论是小程序还是浏览器环境，都使用mqtt.publish发送消息\r\n\t\t\t\tif (this.mqttClient && this.mqttClient.connected) {\r\n\t\t\t\t\tthis.mqttClient.publish('mqttsub', JSON.stringify(command), {\r\n\t\t\t\t\t\tqos: 1\r\n\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\tconsole.error('发送开关命令失败:', err);\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '命令发送失败',\r\n\t\t\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('发送开关命令:', JSON.stringify(command));\r\n\t\t\t\t\t\t\t// 显示发送成功提示\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: `开关${switchIndex + 1}已${this.switches[switchIndex] ? '开启' : '关闭'}`,\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn('MQTT客户端未连接，无法发送命令');\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '设备未连接',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\theight: 100vh;\r\n\t\tbackground-color: #f5f7fa;\r\n\t\tpadding: 20rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t/* 顶部状态栏 */\r\n\t.status-bar {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: flex-end;\r\n\t\tpadding: 20rpx 0;\r\n\t}\r\n\r\n\t.status-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 10rpx 20rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\r\n\t.status-label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\r\n\t.status-value {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.online {\r\n\t\tcolor: #4CAF50;\r\n\t}\r\n\r\n\t.offline {\r\n\t\tcolor: #F44336;\r\n\t}\r\n\r\n\t/* 中间花朵和传感器区域 */\r\n\t.flower-container {\r\n\t\t/* flex: 1; */\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\t/* justify-content: center; */\r\n\t\tmargin: 60rpx 0;\r\n\t}\r\n\r\n\t.flower-wrapper {\r\n\t\twidth: 400rpx;\r\n\t\theight: 400rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 8rpx 30rpx rgba(0, 0, 0, 0.1);\r\n\t\tmargin-bottom: 60rpx;\r\n\t}\r\n\r\n\t.flower-image {\r\n\t\twidth: 300rpx;\r\n\t\theight: 300rpx;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t/* 花心 */\r\n\t.flower-center {\r\n\t\tposition: absolute;\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tbackground-color: #FFD700;\r\n\t\tborder-radius: 50%;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t/* 花瓣 */\r\n\t.petal {\r\n\t\tposition: absolute;\r\n\t\twidth: 40rpx;\r\n\t\theight: 80rpx;\r\n\t\tbackground-color: #FF69B4;\r\n\t\tborder-radius: 50%;\r\n\t\ttop: 30%;\r\n\t\tleft: 50%;\r\n\t\ttransform-origin: center bottom;\r\n\t}\r\n\r\n\t.petal-1 {\r\n\t\ttransform: translate(-50%, -50%) rotate(0deg);\r\n\t}\r\n\r\n\t.petal-2 {\r\n\t\ttransform: translate(-50%, -50%) rotate(45deg);\r\n\t}\r\n\r\n\t.petal-3 {\r\n\t\ttransform: translate(-50%, -50%) rotate(90deg);\r\n\t}\r\n\r\n\t.petal-4 {\r\n\t\ttransform: translate(-50%, -50%) rotate(135deg);\r\n\t}\r\n\r\n\t.petal-5 {\r\n\t\ttransform: translate(-50%, -50%) rotate(180deg);\r\n\t}\r\n\r\n\t.petal-6 {\r\n\t\ttransform: translate(-50%, -50%) rotate(225deg);\r\n\t}\r\n\r\n\t.petal-7 {\r\n\t\ttransform: translate(-50%, -50%) rotate(270deg);\r\n\t}\r\n\r\n\t.petal-8 {\r\n\t\ttransform: translate(-50%, -50%) rotate(315deg);\r\n\t}\r\n\r\n\t/* 茎 */\r\n\t.stem {\r\n\t\tposition: absolute;\r\n\t\twidth: 20rpx;\r\n\t\theight: 120rpx;\r\n\t\tbackground-color: #228B22;\r\n\t\tbottom: 0;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t}\r\n\r\n\t/* 叶子 */\r\n\t.leaf {\r\n\t\tposition: absolute;\r\n\t\twidth: 40rpx;\r\n\t\theight: 20rpx;\r\n\t\tbackground-color: #228B22;\r\n\t\tborder-radius: 50%;\r\n\t\tbottom: 60rpx;\r\n\t}\r\n\r\n\t.leaf-left {\r\n\t\tleft: 35%;\r\n\t\ttransform: rotate(-30deg);\r\n\t}\r\n\r\n\t.leaf-right {\r\n\t\tright: 35%;\r\n\t\ttransform: rotate(30deg);\r\n\t}\r\n\r\n\t/* 传感器数据 */\r\n\t.sensor-data {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-around;\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 20rpx;\r\n\t}\r\n\r\n\t.sensor-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 30rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\r\n\t\tmin-width: 180rpx;\r\n\t}\r\n\r\n\t.sensor-label {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #888;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t.sensor-value {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t/* 底部按钮区域 */\r\n\t.button-container {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-around;\r\n\t\tflex-wrap: wrap;\r\n\t\tpadding: 20rpx 0;\r\n\t}\r\n\r\n\t.control-btn {\r\n\t\twidth: 45%;\r\n\t\theight: 80rpx;\r\n\t\tmargin: 10rpx 0;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 40rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t.control-btn.on {\r\n\t\tbackground: linear-gradient(135deg, #4CAF50, #8BC34A);\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(76, 175, 80, 0.3);\r\n\t}\r\n\r\n\t.control-btn.off {\r\n\t\tbackground: linear-gradient(135deg, #9E9E9E, #757575);\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(0, 0, 0, 0.2);\r\n\t}\r\n\r\n\t.control-btn:active {\r\n\t\ttransform: translateY(2rpx);\r\n\t}\r\n\r\n\t/* 连接状态提示 */\r\n\t.connection-status {\r\n\t\tposition: fixed;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tbackground-color: rgba(0, 0, 0, 0.7);\r\n\t\tcolor: white;\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tz-index: 999;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/Snowrose/Documents/esp32/mqtt/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}